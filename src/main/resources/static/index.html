<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FDU Wordle</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        #guessInput {
            width: 60px;
            text-transform: uppercase;
        }
        .result {
            margin-top: 10px;
        }
        .GRAY { color: gray; }
        .YELLOW { color: goldenrod; }
        .GREEN { color: green; }
    </style>
</head>
<body>
<center>
<h1>FDU Wordle</h1>
<p>Enter your 5-letter guess:</p>
    <form onsubmit="sendGuess(); return false;">
        <input id="guessInput" maxlength="5">
        <button type = "submit">Guess</button>
        <button type = "button" onclick="resetGame()">ResetGame</button>
    </form>
</center>
<div id="messages"></div>
<div id="results"></div>


<script>
    async function resetGame() {
        const response = await fetch(`/api/wordle/reset`, { method: 'POST' });
        await response.json();

        document.getElementById("results").innerHTML = "";
        document.getElementById("messages").innerHTML = "";
        document.getElementById("guessInput").value = "";
        document.getElementById("guessInput").focus();
    }
    async function sendGuess() {
        const guess = document.getElementById("guessInput").value.trim();
        if (!guess) return;

        const response = await fetch(`/api/wordle/guess?guess=${guess}`, { method: 'POST' });
        const data = await response.json();

        // Display guess result
        const resultsDiv = document.getElementById("results");
        const guessEval = data.guessResult.guessEval || [];
        const row = guessEval.map((res, i) => `<span class="${res}">${guess[i].toUpperCase()}</span>`).join(' ');
        const div = document.createElement('div');
        div.className = "result";
        div.innerHTML = row;
        resultsDiv.appendChild(div);

        // Display game status messages
        const messagesDiv = document.getElementById("messages");
        if (data.guessResult.guessStatus == "INVALID") {
            messagesDiv.innerHTML = "<strong>ERROR! Words must contain alphas only</strong>";
        } else if (data.gameStatus.userWon) {
            messagesDiv.innerHTML = "<strong>Congratulations! You guessed the word!</strong>";
        } else if (data.gameStatus.gameOver) {
            messagesDiv.innerHTML = `<strong>Game Over! The word was ${data.gameStatus.secretWord}</strong>`;
        } else {
            messagesDiv.innerHTML = ``;
        }
    }
</script>
</body>
</html>